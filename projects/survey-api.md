# Проект: API сервиса опросов и голосований (Survey API)

## Описание предметной области

Сервис опросов — это платформа, позволяющая создавать анкеты и голосования с различными типами вопросов, собирать ответы от респондентов и анализировать результаты. Такие системы используются для обратной связи от клиентов, внутренних опросов в компаниях, голосований, викторин и исследований.

Ключевые особенности предметной области: гибкая структура данных (опрос содержит вопросы разных типов, каждый тип требует своей валидации ответов), управление жизненным циклом опроса (черновик → опубликован → закрыт) и агрегация результатов.

**Реальные аналоги:** Google Forms, Typeform, SurveyMonkey, Яндекс.Формы.

---

## Функциональные требования

### Пользователи

- Регистрация и авторизация
- Две роли: **автор** (создаёт опросы) и **респондент** (проходит опросы)
- Один и тот же пользователь может быть и автором, и респондентом

### Управление опросами

- Автор создаёт опрос с заголовком и описанием
- Автор добавляет вопросы к опросу
- Поддерживаются типы вопросов: **одиночный выбор**, **множественный выбор**, **текстовый ответ**
- Автор задаёт варианты ответов для вопросов с выбором
- Автор управляет порядком вопросов
- Автор может редактировать опрос, пока он в статусе «черновик»

### Жизненный цикл опроса

- Опрос создаётся как **черновик**
- Автор **публикует** опрос — после этого его можно проходить
- Автор **закрывает** опрос — новые ответы не принимаются
- Опубликованный опрос нельзя редактировать (структуру вопросов)

### Прохождение опросов

- Респондент получает опрос с вопросами и вариантами
- Респондент отправляет ответы
- Система валидирует ответы в зависимости от типа вопроса (например, для одиночного выбора — ровно один вариант)
- Один респондент может пройти один опрос только один раз

### Аналитика

- Автор видит количество респондентов
- По каждому вопросу с выбором: количество и процент ответов по каждому варианту
- По текстовым вопросам: список ответов
- Экспорт результатов в JSON

---

## Стек (на выбор студента)

| Стек    | Фреймворк        | ORM / Работа с БД         |
| ------- | ---------------- | ------------------------- |
| PHP     | Laravel          | Eloquent                  |
| Node.js | Express.js       | Sequelize / Prisma / Knex |
| Python  | Flask или Django | SQLAlchemy / Django ORM   |
| Go      | Gin или Echo     | GORM                      |

База данных: **MySQL** или **PostgreSQL** (на выбор).

---

## Чекпоинты

### 1: Проектирование и старт

**Задачи:**

- Выбрать стек
- Инициализировать проект и Git-репозиторий
- Спроектировать ER-диаграмму базы данных (самостоятельно)
  - Подумать: как хранить разные типы вопросов? Как связать варианты с вопросами? Как хранить ответы респондентов?
- Спроектировать список эндпоинтов API (метод, URL, описание)
- Создать миграции
- Написать README с описанием проекта

**Демо:**

- Репозиторий на GitHub
- ER-диаграмма
- Список спроектированных эндпоинтов
- Миграции запускаются без ошибок

---

### 2: Авторизация и создание опросов

**Задачи:**

- Реализовать регистрацию и авторизацию (JWT)
- CRUD опросов (заголовок, описание, статус)
- Добавление вопросов к опросу (с указанием типа и порядка)
- Добавление вариантов ответов к вопросам с выбором
- Валидация: нельзя добавить варианты к текстовому вопросу
- Подготовить сидеры с тестовыми опросами

**Демо:**

- Живая демонстрация через Postman/Insomnia/curl:
  - Регистрация и логин
  - Создание опроса
  - Добавление вопросов разных типов
  - Добавление вариантов ответов
  - Получение опроса со всеми вопросами и вариантами

---

### 3: Жизненный цикл и прохождение

**Задачи:**

- Реализовать смену статусов: черновик → опубликован → закрыт
- Запретить редактирование структуры опубликованного опроса
- Реализовать получение опроса для прохождения (только опубликованные)
- Отправка ответов респондентом
- Валидация ответов по типу вопроса
- Защита от повторного прохождения

**Демо:**

- Скринкаст или демонстрация:
  - Публикация опроса
  - Прохождение опроса респондентом
  - Попытка повторного прохождения → отказ
  - Попытка пройти закрытый опрос → отказ
  - Попытка редактировать опубликованный опрос → отказ

---

### 4: Аналитика и фильтрация

**Задачи:**

- Подсчёт количества респондентов
- Статистика по вопросам с выбором: количество и процент каждого варианта
- Список текстовых ответов
- Экспорт результатов в JSON
- Пагинация списка опросов
- Фильтрация опросов (мои / активные / завершённые)
- Сортировка (по дате, по количеству ответов)

**Что показать на очной встрече:**

- Живая демонстрация:
  - Создание опроса, прохождение несколькими «пользователями»
  - Просмотр аналитики: процентное распределение, количество ответов
  - Экспорт результатов
  - Фильтрация и пагинация списка опросов

---

### 5: Тесты, Swagger, Docker

**Задачи:**

- Написать автотесты (минимум 5 штук), обязательно покрыть:
  - Валидацию ответов по типам вопросов
  - Защиту от повторного прохождения
  - Жизненный цикл опроса (нельзя редактировать опубликованный)
- Написать Swagger/OpenAPI документацию
- Создать `Dockerfile` для приложения
- Создать `docker-compose.yml` (приложение + база данных)
- Проект должен запускаться одной командой: `docker-compose up`

**Демо:**

- Результат прогона тестов
- Swagger-документация
- Скринкаст: клонирование → `docker-compose up` → API отвечает

---

## Полезные ссылки

**По стекам:**

- Laravel: https://laravel.com/docs
- Express.js: https://expressjs.com
- Flask: https://flask.palletsprojects.com
- Django REST: https://www.django-rest-framework.org
- Gin (Go): https://gin-gonic.com/docs/
- Echo (Go): https://echo.labstack.com/docs

**Инструменты:**

- Swagger/OpenAPI: https://swagger.io/specification/
- dbdiagram.io — проектирование ER-диаграмм
- Postman: https://www.postman.com
- Docker: https://docs.docker.com/get-started/
- Docker Compose: https://docs.docker.com/compose/
